<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
    <title>CrabGrab</title>

    <style>
        html, body {
            background: #000;
            width: 100%;
            height: 100%;
            overflow: hidden;
            padding: 0;
            margin: 0;
        }

        #loading-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: absolute;
            width: 100%;
            height: 100%;
        }

        #logo-container img {
            max-width: 250px;
            height: auto;
            margin-bottom: 20px;
        }

        #progress-bar-container {
            width: 50%;
            max-width: 400px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(to right, #005755, #039567);
            transition: width 0.3s ease;
            position: absolute;
        }

        #progress-text {
            width: 100%;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            color: white;
            position: absolute;
            z-index: 1;
        }

        /* FULLY RESPONSIVE CANVAS */
        #gameContainer, #unity-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
    </style>

<script>
window.SimpleSpectrum={};
window.AudioContext=(function(){
    var q=window.AudioContext||window.webkitAudioContext;
    return function(){
        var ac=new q();
        window.SimpleSpectrum.ac=ac;
        window.SimpleSpectrum.a=ac.createAnalyser();
        window.SimpleSpectrum.a.smoothingTimeConstant=0;
        window.SimpleSpectrum.fa=new Uint8Array(window.SimpleSpectrum.a.frequencyBinCount);
        window.SimpleSpectrum.la=new Uint8Array(window.SimpleSpectrum.a.fftSize);
        window.SimpleSpectrum.a.connect(ac.destination);
        ac.actualDestination=ac.destination;
        Object.defineProperty(ac,'destination',{value:window.SimpleSpectrum.a,writable:false});
        return ac;
    };
})();
</script>

</head>

<body>

    <div id="loading-container">
        <div id="logo-container">
            <img src="./Logo.png" alt="Game Logo">
        </div>
        <div id="progress-bar-container">
            <div id="progress-bar"></div>
            <div id="progress-text">0%</div>
        </div>
    </div>

    <div id="gameContainer">
        <canvas id="unity-canvas"></canvas>

        <script src="Build/ffa8d54dca6f94e670e1bfc47d59e8a5.loader.js"></script>
        <script>
            var canvas = document.querySelector("#unity-canvas");
            var progressBar = document.querySelector("#progress-bar");
            var progressText = document.querySelector("#progress-text");
            var loadingContainer = document.querySelector("#loading-container");
            var nethereumUnityInstance = null;

            var config = {
                dataUrl: "Build/97bc963cbf32ebeac8d94df9e25a725a.data",
                frameworkUrl: "Build/100afc97261ce3d9ee082679b6221371.framework.js",
                codeUrl: "Build/662290d8a47132f933e6c5ffcddf1875.wasm",
                streamingAssetsUrl: "StreamingAssets",
                companyName: "MJH Productions",
                productName: "CrabGrab",
                productVersion: "0.1",
            };

            function progressHandler(progress) {
                var percent = Math.round(progress * 100) + '%';
                progressBar.style.width = percent;
                progressText.innerText = percent;
            }

            // Full responsive scaling
            function onResize() {
                canvas.style.width = "100%";
                canvas.style.height = "100%";
            }

            window.addEventListener("resize", onResize);

            createUnityInstance(canvas, config, progressHandler).then(function(instance) {
                nethereumUnityInstance = instance;

                canvas = instance.Module.canvas;

                onResize(); // apply after unity loads
                loadingContainer.style.display = "none";
            });
        </script>
    </div>

</body>
</html>
